# Malware Activity Detection Rules
# Format: RULE_ID;DESCRIPTION;PATTERN;SEVERITY;FIELDS
#
# Fields reference (0-based index):
# 0 - timestamp
# 1 - source_type
# 2 - source_name
# 3 - log_level
# 4 - username
# 5 - hostname
# 6 - ip_address
# 7 - service
# 8 - process_id
# 9 - message

# Suspicious processes and commands
MW-PROC-001;Base64 Encoded Execution;(echo|printf).*\|.*base64.*\|.*bash;HIGH;9
MW-PROC-002;Suspicious Curl/Wget Usage;(curl|wget).*\|.*bash;HIGH;9
MW-PROC-003;Suspicious File Download;(curl|wget).*-O.*;MEDIUM;9
MW-PROC-004;Reverse Shell Pattern;(bash|nc|python|perl).*-e;HIGH;9
MW-PROC-005;Suspicious Process Name;/tmp/[^[:space:]]+;MEDIUM;9

# Cron job manipulation
MW-CRON-001;Suspicious Cron Job Addition;crontab.*-e;MEDIUM;9
MW-CRON-002;Cron File Modification;/etc/cron;MEDIUM;9

# Persistence mechanisms
MW-PERS-001;SSH Authorized Keys Modified;authorized_keys;MEDIUM;9
MW-PERS-002;Startup Script Modified;(/etc/init|/etc/systemd|rc\.d);MEDIUM;9
MW-PERS-003;Scheduled Task Creation;at command|atd;MEDIUM;9
MW-PERS-004;Shell Configuration Modified;(\.bashrc|\.bash_profile|\.profile);MEDIUM;9

# Network activity
MW-NET-001;Suspicious Outbound Connection;ESTABLISHED.*foreign;MEDIUM;9
MW-NET-002;Unusual Listening Port;LISTEN.*;HIGH;9
MW-NET-003;DNS Tunneling Pattern;dig.*txt;MEDIUM;9
MW-NET-004;High Volume Network Traffic;(tx|rx)_bytes;MEDIUM;9

# File operations
MW-FILE-001;Suspicious File Creation;touch.*/tmp/;LOW;9
MW-FILE-002;Unexpected Binary Execution;/dev/shm|/var/tmp;MEDIUM;9
MW-FILE-003;Log File Deletion;rm.*/var/log/;HIGH;9
MW-FILE-004;Log File Truncation;truncate|>.*;HIGH;9

# Known malware signatures - add specific patterns as needed
MW-SIG-001;Linux.Encoder Ransomware;Linux\.Encoder;CRITICAL;9
MW-SIG-002;Mirai Botnet Signature;mirai;CRITICAL;9
MW-SIG-003;Coinminer Detection;(cryptonight|stratum\+tcp);HIGH;9